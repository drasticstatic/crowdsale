# App.js Documentation
&nbsp;&nbsp;&nbsp;&nbsp;visit '../components/_w_notes/"".js' for code w/ embedded notes
## Overview
The main React component for our DApp that handles:
- Connecting to the Ethereum blockchain
- Loading smart contract data
- Displaying the user interface
- Managing the token purchase process

## Key Components

### Imports
- **React Hooks**: `useEffect`, `useState`, `useRef` for state and lifecycle management
- **UI Components**: Navigation, Buy, Progress, Info, Loading
- **Blockchain**: ethers.js for Ethereum interaction
- **Contract Artifacts**: ABI files that define how to interact with smart contracts
- **Configuration**: Network-specific addresses for contracts

### State Variables

#### References
- `configRef`: Stores the config object to avoid re-renders
- `tokenAbiRef`, `crowdsaleAbiRef`: Store contract ABIs
- `ethersRef`: Stores ethers library
- `ethereumRef`: Reference to window.ethereum (MetaMask)

#### Blockchain Connection
- `provider`: Connection to Ethereum network
- `crowdsale`: Crowdsale contract instance

#### User Account
- `account`: User's Ethereum address (empty string by default)
- `accountBalance`: User's token balance

#### Token Sale
- `price`: Price per token in ETH
- `maxTokens`: Total tokens available for sale
- `tokensSold`: Number of tokens already sold

#### UI State
- `isLoading`: Controls showing loading spinner

### Main Functions

#### `loadBlockchainData`
This function:
1. Checks if MetaMask is installed
2. Requests account access
3. Initializes the provider
4. Checks MetaMask connection
5. Fetches the network/chain ID
6. Determines the correct configuration based on the network
7. Checks if the network is supported
8. Initializes contract instances
9. Fetches account and token data
10. Updates state variables

#### `useEffect` Hook
Calls `loadBlockchainData` when the component mounts or when `isLoading` changes.

### Rendering
- Shows loading spinner when data is loading
- Displays token price, buy form, and progress bar when loaded
- Shows account info if connected

## Notes on ABIs
ABIs are JSON files generated by the Solidity compiler when we compile our smart contracts. They contain the contract's functions, events, and types, and are used by the ethers.js library to create contract instances that we can use to interact with the blockchain.

Be sure to update (copy) the latest ABI artifacts: 'token.json' and 'crowdsale.json' from build directory (after compiling) and paste into the 'src/abis' directory.

## ESLint Workarounds
The code uses `useRef` to store objects that don't change between renders (like config, ABIs, and libraries) to avoid ESLint warnings about missing dependencies in hooks.

## Network Handling
The app checks for the correct network and uses appropriate contract addresses based on the network ID. For local development (Hardhat, chainId 31337), it uses the "localDevelopmentNetwork" configuration.